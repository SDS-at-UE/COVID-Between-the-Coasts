---
title: 'COVID-19:  A Midwestern Reporting Project of WNIN and the University of Evansville'
author: "Minneapolis Zip Code Analysis"
date: "Analysis performed by Maya Frederick, Timmy Miller, Ethan Morlock, Pearl Muensterman, and Darrin Weber, Ph.D."
output: html_document
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidycensus)
library(tidyverse)
library(leaflet)
library(stringr)
library(sf)
library(tigris)
source("../Scripts/functions.R")
options(tigris_use_cache = TRUE)
variables_2018 <- load_variables(2018, "acs5", cache = TRUE) %>%
  rename(variable = name)
zip_code <- read_csv("../Data/zip_county.csv")
zip_code_minn <- zip_code %>% filter(primary_city == "Minneapolis",
                                      state == "MN")
minn_covid <- read_csv("../Data/minnesota_covid_data.csv",
                        col_types = cols(ZIP = col_character())) %>%
  filter(ZIP %in% zip_code_minn$zip)
minn_covid$Cases <- if_else(minn_covid$Cases == "<=5", 5, as.numeric(minn_covid$Cases))
minn_population <- get_acs(geography = "zcta",
                           variable = "B01003_001") %>%
  filter(GEOID %in% zip_code_minn$zip)
minneapolis_covid <- left_join(minn_population, minn_covid, by = c("GEOID" = "ZIP"))
minneapolis_covid <- minneapolis_covid %>% 
  rename(ZIP = GEOID,
         Population = estimate) %>%
  mutate(case_rate = Cases/Population)
minneapolis_covid <- select(minneapolis_covid, ZIP, Population, Cases, case_rate) %>%
  filter(ZIP != '55450')
```

## Background

The goal of this analysis is to find any connections, if they exist, between demographic data and the outbreak of COVID-19 in the city of Minneapolis. Demographic data was obtained from the Census Bureau through their 5-year American Community Survey published in 2018 (the most recent 5-year data available). COVID-19 case numbers were obtained from the Minnesota Department of Health and minnesota_covid_data. (https://www.health.state.mn.us/diseases/coronavirus/situation.html#map1). 

## Summary

To start off we filtered the ZIP code 55450 out of the dataset because it was an outlier in every varible we analyzed that affected every test we ran on the data.  The largest positive correlation is African Americans with a correlation of 0.784.  This is followed by families who make 30K or less a year at a correlation of 0.702. We then have people who have public insurance with a correlation of 0.686, which is followed closely by people receiving public assistance at 0.684.  The other positive correlations we have are not being a U.S. citizen with a correlation of 0.611, public transportation with a correlation of 0.549, and lastly, essential workers with a correlation of 0.409.  The biggest negative correlation is private health insurance at -0.803. Then families who make 100K or more a year is at -0.761.  The other negative correlation we have is nonessential workers with a correlation of -0.409.  The last variable we have is gini index with a correlation of 0.059.  The p-value of this correlation is so close to 1 that we can't conclude there is any real difference.  

## Analysis

## Occupations (Essential VS. Nonessential)

```{r}
minn_occupation <- get_acs(geography = "zcta",
                           table = "C24060") %>% 
  filter(GEOID %in% zip_code_minn$zip,
         !variable %in% c("C24060_001"),
         GEOID != '55450')

minn_occupation <- left_join(minn_occupation, variables_2018[, 1:2], by = "variable")

minn_occupation$label <- as_factor(str_replace(minn_occupation$label, ".*!!(.*)", "\\1"))
```

Analyzing Essential Occupations
```{r}
minn_occupation_essen <- minn_occupation %>% 
  group_by(GEOID) %>% 
  mutate(n = sum(estimate),
         prop = estimate/n) %>% 
  filter(label %in% c("Natural resources, construction, and maintenance occupations",
                      "Production, transportation, and material moving occupations")) %>% 
  mutate(prop_essen = sum(prop)) %>% 
  select(GEOID, prop_essen) %>% 
  distinct(GEOID, prop_essen)

lvls <- minn_occupation_essen %>% 
  arrange(prop_essen) %>% 
  pull(GEOID)

minn_occupation <- left_join(minn_occupation, minneapolis_covid, by = c("GEOID" = "ZIP"))

ggplot(minn_occupation) +
  geom_col(aes(factor(GEOID, levels = lvls), estimate, fill = label),
           position = "fill") +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 1)) +
  labs(title = "Occupations for Each Minneapolis Zip Code",
       x = "Zip Code",
       y = "Proportion", 
       fill = "Occupation")
```

The scatterplot show the correlation between Essential jobs and COVID cases. 
```{r}
minn_occupation_essen_cor <- left_join(minn_occupation_essen, minneapolis_covid, by = c("GEOID" = "ZIP"))
ggplot(minn_occupation_essen_cor) +
  geom_point(aes(x = prop_essen, y = case_rate)) +
  labs(title = "Correlation Between Essential Jobs and COVID",
       x = "Proportion of Essential Workers",
       y = "Case Rate (per 100,000)")
```

Test correlation between population with essential jobs to case rate of COVID. 
```{r}
cor.test(minn_occupation_essen_cor$prop_essen, minn_occupation_essen_cor$case_rate, use = "complete.obs")
```
The correlation between essential jobs and case rate is shown to be 0.409.  This positive correlation means the more essential jobs have a higher rate of contracting COVID. 

Analyzing Nonessential Occupations
```{r}
minn_occupation_nonessen <- minn_occupation %>% 
  group_by(GEOID) %>% 
  mutate(n = sum(estimate),
         prop = estimate/n) %>% 
  filter(label %in% c("Management, business, science, and arts occupations",
                      "Service occupations",
                      "Sales and office occupations")) %>% 
  mutate(prop_nonessen = sum(prop)) %>% 
  select(GEOID, prop_nonessen) %>% 
  distinct(GEOID, prop_nonessen)

lvls <- minn_occupation_nonessen %>% 
  arrange(prop_nonessen) %>% 
  pull(GEOID)

minn_occupation <- left_join(minn_occupation, minneapolis_covid, by = c("GEOID" = "ZIP"))

ggplot(minn_occupation) +
  geom_col(aes(GEOID, estimate, fill = label),
           position = "fill") +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 1)) +
  labs(title = "Occupations for Each Minneapolis Zip Code",
       x = "Zip Code",
       y = "Proportion", 
       fill = "Occupation")
```

The scatterplot shows the correlation between Nonessential jobs and COVID cases for ZIP codes. 
```{r}
minn_occupation_nonessen_cor <- left_join(minn_occupation_nonessen, minneapolis_covid, by = c("GEOID" = "ZIP"))
ggplot(minn_occupation_nonessen_cor) +
  geom_point(aes(x = prop_nonessen, y = case_rate)) +
  labs(title = "Correlation Between Nonessential Jobs and COVID",
       x = "Proportion of Nonessential Workers",
       y = "Case Rate (per 100,000)")
```

Test correlation between population with nonessential jobs to the case rate of COVID
```{r}
cor.test(minn_occupation_nonessen_cor$prop_nonessen, minn_occupation_nonessen_cor$case_rate, use = "complete.obs")
```
The correlation between nonessential jobs and case rate is -0.409.  This means the people with nonessential jobs are less likely to get COVID. 

## Citizenship

```{r}
minn_citi <- get_acs(geography = "zcta",
                        table = "B05001") %>% 
  filter(GEOID %in% zip_code_minn$zip,
         !variable %in% c("B05001_001"))
minn_citi <- left_join(minn_citi, variables_2018[, 1:2], by = "variable")
minn_citi$label <- as_factor(str_replace(minn_citi$label, ".*!!(.*)", "\\1"))
```

Analyze citizenship
```{r}
minn_citi_status <- minn_citi %>% 
  group_by(GEOID) %>% 
  mutate(n = sum(estimate),
         prop = estimate/n) %>% 
  filter(label %in% c("Not a U.S. citizen")) %>% 
  mutate(prop_not_citizen = sum(prop)) %>% 
  select(GEOID, prop_not_citizen) %>% 
  distinct(GEOID, prop_not_citizen)

lvls <- minn_citi_status %>% 
  arrange(prop_not_citizen) %>% 
  pull(GEOID)

minn_citi <- left_join(minn_citi, minneapolis_covid, by = c("GEOID" = "ZIP"))

ggplot(minn_citi) +
  geom_col(aes(factor(GEOID, levels = lvls), estimate, fill = label),
           position = "fill") +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 1)) +
  labs(title = "Citizenship Status for Each Minneapolis Zip Code",
       x = "Zip Code",
       y = "Proportion", 
       fill = "Citizenship Status")
```

The scatterplot shows the correlation between not being a U.S. citizen and COVID.
```{r}
minn_citi_cor <- left_join(minn_citi_status, minneapolis_covid, by = c("GEOID" = "ZIP"))
ggplot(minn_citi_cor) +
  geom_point(aes(x = prop_not_citizen, y = case_rate)) +
  labs(title = "Correlation Between Not Being a U.S. Citizen and COVID",
       x = "Proportion of Non U.S. Citizens",
       y = "Case Rate (per 100,000)")
```

Test correlation between precentage of population that is not a U.S. citizen to case rate.
```{r}
cor.test(minn_citi_cor$prop_not_citizen, minn_citi_cor$case_rate, use = "complete.obs")
```
The correlation between being a non-citizen and case rate is 0.611.  This is a positive correlation which means a non-citizen is more likely to get COVID. 

## Income 

```{r}
minn_income <- get_acs(geography = "zcta",
                        table = "B19101") %>% 
  filter(GEOID %in% zip_code_minn$zip,
         !variable %in% c("B19101_001"))
minn_income <- left_join(minn_income, variables_2018[, 1:2], by = "variable")
minn_income$label <- as_factor(str_replace(minn_income$label, ".*!!(.*)", "\\1"))
```

Analyzing 100K and over income
```{r}
minn_income__sixfig <- minn_income %>% 
  group_by(GEOID) %>% 
  mutate(n = sum(estimate),
         prop = estimate/n) %>% 
  filter(label %in% c("$200,000 or more",
                      "$150,000 to $199,999",
                      "$125,000 to $149,999",
                      "$100,000 to $124,999")) %>% 
  mutate(prop_100K = sum(prop)) %>% 
  select(GEOID, prop_100K) %>% 
  distinct(GEOID, prop_100K)

lvls <- minn_income__sixfig %>% 
  arrange(prop_100K) %>% 
  pull(GEOID)

minn_income <- left_join(minn_income, minneapolis_covid, by = c("GEOID" = "ZIP"))

ggplot(minn_income) +
  geom_col(aes(factor(GEOID, levels = lvls), estimate, fill = label),
           position = "fill") +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 1)) +
  labs(title = "Income Status in past year per household for Each Minneapolis Zip Code",
       x = "Zip Code",
       y = "Proportion", 
       fill = "Income Status")
```

The scatterplot shows the correlation betweeen families making a six figure income or more and COVID. 
```{r}
minn_income_sixfig_cor <- left_join(minn_income__sixfig, minneapolis_covid, by = c("GEOID" = "ZIP"))
ggplot(minn_income_sixfig_cor) +
  geom_point(aes(x = prop_100K, y = case_rate)) +
  labs(title = "Correlation Between Families Making 100K or More and COVID",
       x = "Proportion of Families Making 100K or More",
       y = "Case Rate (per 100,000)")
```

Test correlation between percent of population making six figure incomes to case rate of COVID
```{r}
cor.test(minn_income_sixfig_cor$prop_100K, minn_income_sixfig_cor$case_rate, use = "complete.obs")
```
The correlation between a six figure income and case rate is a correlation of -0.761.  This is a big negative correlation which means people who are making a six figure income are less likely to get COVID. 

Analyzing 30K and under income
```{r}
minn_income_30K_below <- minn_income %>% 
  group_by(GEOID) %>% 
  mutate(n = sum(estimate),
         prop = estimate/n) %>% 
  filter(label %in% c("$25,000 to $29,999",
                      "$20,000 to $24,999",
                      "$15,000 to $19,999",
                      "$10,000 to $14,999",
                      "Less than $10,000")) %>% 
  mutate(prop_30K = sum(prop)) %>% 
  select(GEOID, prop_30K) %>% 
  distinct(GEOID, prop_30K)

lvls <- minn_income_30K_below %>% 
  arrange(prop_30K) %>% 
  pull(GEOID)

minn_income <- left_join(minn_income, minneapolis_covid, by = c("GEOID" = "ZIP"))

ggplot(minn_income) +
  geom_col(aes(factor(GEOID, levels = lvls), estimate, fill = label),
           position = "fill") +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 1))+
labs(title = "Income Status in past year per household for Each Minneapolis Zip Code",
       x = "Zip Code",
       y = "Proportion", 
       fill = "Income Status")
```

The scatterplot shows the correlation between families making less than 30K and COVID. 
```{r}
minn_income_30K_below_cor <- left_join(minn_income_30K_below, minneapolis_covid, by = c("GEOID" = "ZIP"))
ggplot(minn_income_30K_below_cor) +
  geom_point(aes(x = prop_30K, y = case_rate)) +
  labs(title = "Correlation Between Families Making 30K or Less and COVID",
       x = "Proportion of Families Making 30K or Less",
       y = "Case Rate (per 100,000)")
```

Test correlation between percent of population making 30K and under incomes to case rate of COVID
```{r}
cor.test(minn_income_30K_below_cor$prop_30K, minn_income_30K_below_cor$case_rate, use = "complete.obs")
```
The correlation between a smaller income and case rate is 0.702.  This is a big positive correlation.  This means poorer people who are making less money are way more likely to get COVID than people who are making a lot of money. 

## Race

```{r}
minn_race <- get_acs(geography = "zcta",
                        table = "B02001") %>% 
  filter(GEOID %in% zip_code_minn$zip,
         !variable %in% c("B02001_001"))
minn_race <- left_join(minn_race, variables_2018[, 1:2], by = "variable")
minn_race$label <- as_factor(str_replace(minn_race$label, ".*!!(.*)", "\\1"))
```

Analyzing Afican Americans in Minneapolis
```{r}
minn_AA <- minn_race %>% 
  group_by(GEOID) %>% 
  mutate(n = sum(estimate),
         prop = estimate/n) %>% 
  filter(label %in% c("Black or African American alone")) %>% 
  mutate(prop_AA = sum(prop)) %>% 
  select(GEOID, prop_AA) %>% 
  distinct(GEOID, prop_AA)

lvls <- minn_AA %>% 
  arrange(prop_AA) %>% 
  pull(GEOID)

minn_race <- left_join(minn_race, minneapolis_covid, by = c("GEOID" = "ZIP"))

ggplot(minn_race) +
  geom_col(aes(factor(GEOID, levels = lvls), estimate, fill = label),
           position = "fill") +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 1)) +
  labs(title = "Racial Status for Each Minneapolis Zip Code",
       x = "Zip Code",
       y = "Proportion", 
       fill = "Racial Status")

```

The scatterplot shows the correlation between being an African American and COVID. 
```{r}
minn_race_cor <- left_join(minn_AA, minneapolis_covid, by = c("GEOID" = "ZIP"))
ggplot(minn_race_cor) +
  geom_point(aes(x = prop_AA, y = case_rate)) +
  labs(title = "Correlation Between Being an African American and COVID",
       x = "Proportion of African Americans",
       y = "Case Rate (per 100,000)")
```

Test correlation between percentage of population that is African American and case rate of COVID
```{r}
cor.test(minn_race_cor$prop_AA, minn_race_cor$case_rate, use = "complete.obs")
```
The correlation between being an African American and case rate is 0.784.  This is a big positive correlation meaning African Americans are more likely to get COVID.  

## Gini Index

```{r}
minn_gini <- get_acs(geography = "zcta",
                        table = "B19083") %>% 
  filter(GEOID %in% zip_code_minn$zip)
minn_gini <- left_join(minn_gini, variables_2018[, 1:2], by = "variable")
minn_gini$label <- as_factor(str_replace(minn_gini$label, ".*!!(.*)", "\\1"))
```

Analyze Gini Index for Minneapolis.  The scatterplot shows the correlation between Gini Index and COVID.
```{r}
minn_gini <- left_join(minn_gini, minneapolis_covid, by = c("GEOID" = "ZIP"))
minn_gini <- filter(minn_gini, GEOID != '55450')

ggplot(minn_gini) +
  geom_point(aes(x = estimate, y = case_rate)) +
  labs(title = "Gini Index for Each Minneapolis Zip Code",
       x = "Gini Index",
       y = "Case Rate")

```

Test correlation between gini index and case rate of COVID
```{r}
cor.test(minn_gini$estimate, minn_gini$case_rate, use = "complete.obs")
```
The correlation between gini index and case rate is 0.059.  This is a low positive number with a p-value close to 1, so we can't conclude anything about gini index and COVID. 

## Insurance Coverage

```{r}
minn_insurance <- get_acs(geography = "zcta",
                           table = "B18135") %>% 
  filter(GEOID %in% zip_code_minn$zip,
         !variable %in% c("B18135_023"))
minn_insurance <- left_join(minn_insurance, variables_2018[, 1:2], by = "variable")
minn_insurance$label <- as_factor(str_replace(minn_insurance$label, ".*!!(.*)", "\\1"))
```

Analyze private health insurance coverage
```{r}
minn_insurance_private <- minn_insurance %>% 
  group_by(GEOID) %>% 
  mutate(n = sum(estimate),
         prop = estimate/n) %>% 
  filter(label %in% c("With private health insurance coverage")) %>% 
  mutate(prop_priv = sum(prop)) %>% 
  select(GEOID, prop_priv) %>% 
  distinct(GEOID, prop_priv)

lvls <- minn_insurance_private %>% 
  arrange(prop_priv) %>% 
  pull(GEOID)

minn_insurance <- left_join(minn_insurance, minneapolis_covid, by = c("GEOID" = "ZIP"))

ggplot(minn_insurance) +
  geom_col(aes(factor(GEOID, levels = lvls), estimate, fill = label),
           position = "fill") +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 1)) +
  labs(title = "Insurance Coverage for Each Minneapolis Zip Code",
       x = "Zip Code",
       y = "Proportion", 
       fill = "Insurance Coverage")
```

The scatterplot shows the correlation between private health insurance and COVID.
```{r}
minn_private_cor <- left_join(minn_insurance_private, minneapolis_covid, by = c("GEOID" = "ZIP"))
ggplot(minn_private_cor) +
  geom_point(aes(x = prop_priv, y = case_rate)) +
  labs(title = "Correlation Between Private Health Insurance and COVID",
       x = "Proportion of People with Private Health Insurance",
       y = "Case Rate (per 100,000)")
```

Test correlation between percentage of population with private health insurance and case rate of COVID
```{r}
cor.test(minn_private_cor$prop_priv, minn_private_cor$case_rate, use = "complete.obs")
```
The correlation between private health insurance and case rate is -0.803.  This is a big negative correlation. People with private health insurance have been contracting less cases of COVID. 

Analyze public health insurance coverage
```{r}
minn_insurance_public <- minn_insurance %>% 
  group_by(GEOID) %>% 
  mutate(n = sum(estimate),
         prop = estimate/n) %>% 
  filter(label %in% c("With public health coverage")) %>% 
  mutate(prop_public = sum(prop)) %>% 
  select(GEOID, prop_public) %>% 
  distinct(GEOID, prop_public)

lvls <- minn_insurance_public %>% 
  arrange(prop_public) %>% 
  pull(GEOID)

minn_insurance <- left_join(minn_insurance, minneapolis_covid, by = c("GEOID" = "ZIP"))

ggplot(minn_insurance) +
  geom_col(aes(factor(GEOID, levels = lvls), estimate, fill = label),
           position = "fill") +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 1)) +
  labs(title = "Insurance Coverage for Each Minneapolis Zip Code",
       x = "Zip Code",
       y = "Proportion", 
       fill = "Insurance Coverage")
```

The scatterplot shows the correlation between public health insurance and COVID. 
```{r}
minn_public_cor <- left_join(minn_insurance_public, minneapolis_covid, by = c("GEOID" = "ZIP"))
ggplot(minn_public_cor) +
  geom_point(aes(x = prop_public, y = case_rate)) +
  labs(title = "Correlation Between Public Health Insurance and COVID",
       x = "Proportion of People with Public Health Insurance",
       y = "Case Rate (per 100,000)")
```

Test correlation between percentage of population with public health insurance and case rate of COVID
```{r}
cor.test(minn_public_cor$prop_public, minn_public_cor$case_rate, use = "complete.obs")
```
The correlation between public health insurance and case rate is 0.686.  This is a positive realtionship.  The people with public insurance have been contracting more cases of COVID. 

## Public Assistance Income

```{r}
minn_stamps <- get_acs(geography = "zcta",
                          table = "B19058") %>% 
  filter(GEOID %in% zip_code_minn$zip,
         !variable %in% c("B19058_002"))
minn_stamps <- left_join(minn_stamps, variables_2018[, 1:2], by = "variable")
minn_stamps$label <- as_factor(str_replace(minn_stamps$label, ".*!!(.*)", "\\1"))
```

Analyzing families that accepted public assistance income in Minneapolis
```{r}
minn_stamps_with <- minn_stamps %>% 
  group_by(GEOID) %>% 
  mutate(n = sum(estimate),
         prop = estimate/n) %>% 
  filter(label %in% c("Total")) %>% 
  mutate(prop_stamps = sum(prop)) %>% 
  select(GEOID, prop_stamps) %>% 
  distinct(GEOID, prop_stamps)

lvls <- minn_stamps_with %>% 
  arrange(prop_stamps) %>% 
  pull(GEOID)

minn_stamps <- left_join(minn_stamps, minneapolis_covid, by = c("GEOID" = "ZIP"))

ggplot(minn_stamps) +
  geom_col(aes(factor(GEOID, levels = lvls), estimate, fill = label),
           position = "fill") +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 1)) +
  labs(title = "Public Assistance Distribution for Each Minneapolis Zip Code",
       x = "Zip Code",
       y = "Proportion", 
       fill = "Public Assistance")

```

The scatterplot shows the correlation between families receiving public assistance and COVID. 
```{r}
minn_stamps_cor <- left_join(minn_stamps_with, minneapolis_covid, by = c("GEOID" = "ZIP"))
ggplot(minn_stamps_cor) +
  geom_point(aes(x = prop_stamps, y = case_rate)) +
  labs(title = "Correlation Between Families Receiving Public Assistance and COVID",
       x = "Proportion of Families Receiving Public Assistance",
       y = "Case Rate (per 100,000)")
```

Test correlation between percentage of population that accepted public assistance and case rate of COVID
```{r}
cor.test(minn_stamps_cor$prop_stamps, minn_stamps_cor$case_rate, use = "complete.obs")
```
The correlation between public assistance and case rate is 0.684.  This is a positive relationship meaning families receiving public assistance and more likely to get COVID.  

## Transportation to Work

```{r}
minn_transport <- get_acs(geography = "zcta",
                       table = "B08301") %>% 
  filter(GEOID %in% zip_code_minn$zip,
         !variable %in% c("B08301_010"))
minn_transport <- left_join(minn_transport, variables_2018[, 1:2], by = "variable")
minn_transport$label <- as_factor(str_replace(minn_transport$label, ".*!!(.*)", "\\1"))
```

Analyzing public transporation
```{r}
minn_transport_public <- minn_transport %>% 
  group_by(GEOID) %>% 
  mutate(n = sum(estimate),
         prop = estimate/n) %>% 
  filter(label %in% c("Public transportation (excluding taxicab)",
                      "Bus or trolley bus",
                      "Streetcar or trolley car (carro publico in Puerto Rico)",
                      "Subway or elevated",
                      "Railroad")) %>% 
  mutate(prop_pub = sum(prop)) %>% 
  select(GEOID, prop_pub) %>% 
  distinct(GEOID, prop_pub)

lvls <- minn_transport_public %>% 
  arrange(prop_pub) %>% 
  pull(GEOID)

minn_transport <- left_join(minn_transport, minneapolis_covid, by = c("GEOID" = "ZIP"))

ggplot(minn_transport) +
  geom_col(aes(factor(GEOID, levels = lvls), estimate, fill = label),
           position = "fill") +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 1)) +
  labs(title = "Transportation Distribution for Each Minneapolis Zip Code",
       x = "Zip Code",
       y = "Proportion", 
       fill = "Transportation")
```

The scatterplot shows the correlation between public transportation and COVID.
```{r}
minn_trans_cor <- left_join(minn_transport_public, minneapolis_covid, by = c("GEOID" = "ZIP"))
ggplot(minn_trans_cor) +
  geom_point(aes(x = prop_pub, y = case_rate)) +
  labs(title = "Correlation Between Public Transportation and COVID",
       x = "Proportion of People Using Public Transportation",
       y = "Case Rate (per 100,000)")
```

Test the correlation between the percentage of the population using public transportation and case rate of COVID
```{r}
minn_trans_cor <- left_join(minn_transport_public, minneapolis_covid, by = c("GEOID"="ZIP"))
cor.test(minn_trans_cor$prop_pub, minn_trans_cor$case_rate, use = "complete.obs")
```
The correlation between public transportation and case rate is 0.549.  This is a positive relationship meaning people using public transportation are more likely to get COVID.  


## Conclusions

In Minneapolis we looked at 8 different categories and analyzed 11 variables within them by zip code.  We had to remove ZIP code 55450 because it was skewing the data.  It was an outlier is every variable we looked at that and when we looked into it we saw that it had a very small population with a lot of cases so that explains why it was changing all of our correlations by a lot.  We did choose the essential jobs in our report to be natural resources, construction, maintenance, production, transportation, and material moving occupations.  For our nonessential jobs we chose management, business, science, arts, service, sales and office occupations.  We had four variables stick out when analyzing this data.  Two of them were positive correlations, the highest being African Americans and familes that had an income of 30 thousand dollars a year or less.  The other two variables were negative correlations being people with private health insurance and families making 100 thousand dollars or more a year.  I was not surpised by the correlations of the income variables.  I was suprised that the correlation of African Americans and COVID was such a big positive correlation.  I was not by the families receiving public assistance beause I figured that would go hand in hand with families making 30 thousand or less a year. The essential and nonessential jobs were not surprising.  The gini index did not have a significant p-value so we could conclude that there was no real differnece there. 