---
title: 'COVID-19: A Midwestern Reporting Project of WNIN and the University of Evansville'
author: "Columbus ZIP Code Analysis"
date: "Analysis performed by Maya Frederick, Timmy Miller, Ethan Morlock, Pearl Muensterman, and Darrin Weber, Ph.D."
output: html_document
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
options(scipen = 999, digits = 6)
library(tidycensus)
library(tidyverse)
library(leaflet)
library(sf)
library(tigris)
options(tigris_use_cache = TRUE)
variables_2018 <- load_variables(2018, "acs5", cache = TRUE) %>%
  rename(variable = name)
zip_code <- read_csv("../Data/zip_county.csv")
zip_code_col <- zip_code %>% filter(primary_city == "Columbus", state == "OH")
geometry_zip <- read_sf("../Data/All_zips.shp", type = 6)
geometry_zip_col <- filter(geometry_zip, GEOID %in% zip_code_col$zip)
col_covid <- read_excel("../Data/columbus_covid.xlsx")
```

## Background

The goal of this analysis is to find any connections, if they exist, between demographic data and the outbreak of COVID-19 in the city of Columbus. Demographic data was obtained from the Census Bureau through their 5-year American Community Survey published in 2018 (the most recent 5-year data available). COVID-19 case numbers were obtained from the Columbus Public Health Department ([https://public.tableau.com/views/COVID-19OutbreakSummary_15918845768300/COVID19Summaryp3?%3Adisplay_count=y&%3Aorigin=viz_share_link&%3AshowVizHome=no]). 

Throughout the document, we report the $p$-value for several statistical tests. This does nothing more than provide a measure on the amount of evidence we have to suggest statistical significance. The closer the $p$-value is to 0 the stronger the evidence that our measure (correlation most of the time) is different than 0. 

**Conclusions:**

## Analysis

### COVID

We first look at the COVID cases by ZIP codes. The city of Columbus reported their data in ranges instead of exact numbers. To be able to conduct analysis we took the average of that particular range for that ZIP code. That is why ZIP codes of the same color have the exact same case rate. Columbus does not seem to have any outliers as there is a nice spread of the COVID case rate. As you can see the more metropolitan areas have a little bit higher case rate which is what is expected. 

```{r}
geometry_zip_col$GEOID <- as.numeric(geometry_zip_col$GEOID)
col_covid_geo <- left_join(col_covid, geometry_zip_col, by = c("ZIP" = "GEOID"))
col_covid_geo <- st_as_sf(col_covid_geo, sf_column_name = "geometry")
```

```{r}
pal <- colorNumeric(palette = "viridis", domain = col_covid_geo$average)
col_covid_geo %>% 
  st_transform(crs = "+init=epsg:4326") %>% 
  leaflet(width = "100%") %>% 
  addProviderTiles(provider = "CartoDB.Positron") %>% 
  addPolygons(popup = str_c("<strong>", col_covid_geo$ZIP,
                            "</strong><br /> Case Rate ", signif(col_covid_geo$average, digits = 4)),
              weight = 4,
              smoothFactor = 0,
              fillOpacity = 0.7,
              color = ~ pal(average)) %>% 
  addLegend("bottomright",
            pal = pal,
            values = ~ average,
            title = "Case Rate (per 100000)",
            opacity = 1)
```

